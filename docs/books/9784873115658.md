# リーダブルコード - より良いコードを書くためのシンプルで実践的なテクニック

<div class="text-center">
    <img src="/img/cover/9784873115658.jpeg" alt="本の表紙" class="inline-block">
</div>

<div class="text-center">
    <a href="https://www.oreilly.co.jp/books/9784873115658/" class="text-center">
        リーダブルコード - より良いコードを書くためのシンプルで実践的なテクニック
    </a>
</div>

## この本を読んだきっかけ

バイト先で、この書籍がおすすめされていたから読んだ。初めてのチーム開発で、他の人が読みやすいコードを書くのに必要な技術を取得することが目標だった。

## まとめ

### 読みやすいコード

コードは他の人が最短時間で理解できるように書かなければならない。ここでの「他の人」には**未来の自分**も含まれる。このコードを他の人が見ないからと言って、読みにくいコードを書くのは、将来自分の首を絞めることになってしまう。

### 命名

変数や関数、クラスは**名前**を定義する必要がある。名前は直接プログラムの動作には関係しない。しかし、読みやすいコードを書く上では重要な要素である。そのために、名前を**短いコメント**だとして、適切に**命名**する必要がある。名前に情報を込めるために以下のようなルールがある。

- **明確な単語を選ぶ。**
  - 例えば「get」のように、連想される動作がたくさんある単語は避けるべきである。代わりに「download」や「fetch」という明確な単語を使う。
- **接尾辞や接頭辞を使って情報を追加する**
  - 他の開発者に伝えるべき情報を名前に追加する。手当たり次第に追加するのではなく、名前の意味を誤解した時にバグになりそうな場合に追加する。
- **名前のフォーマットで情報を伝える**
  - JavaScript では、コンストラクタは大文字で始め、通常の関数は小文字で始める。このようにフォーマットを気にする必要がある。

名前に情報を乗せる時に、名前が**誤解**されないように気を付ける必要がある。意味が曖昧な単語をよく使用してしまいがちなので、自分の想定に対する反対意見を想像しながら命名する必要がある。

### フォーマット

**フォーマット**は、「命名」同様に、プログラムの動作に関係しない要素である。フォーマットは、**余白・配置・順序**の 3 つの要素に分解できる。読みやすいという意味での、**美しい**コードを書くために次の原則を考える。

- 読み手が慣れているパターンと一貫性のあるレイアウトを使う。
  - コードを並べる時、重要度順で整列したり、別で使用されている順序に合わせたりする。以降も同様の順序で記述し、一貫性を保つ。
- 似ているコードは似ているように見せる。
  - 開始位置を揃えることで、流し読みが楽にできるようになる。
- 関連するコードをまとめてブロックにする。
  - 羅列されたコードを、意味のあるグループに分けて記述する。さらに、段落ごとにコメントをつけるとなお良い。

### コメント

**コメント**の目的は、書き手の意図を読み手に知らせることである。

コメントには価値を持たせる必要がある。価値のないコメントは読み手にとってノイズにしかならないためである。コードからすぐに分かることや、ひどいコードを補うためにコメントは使うべきではない。コメントをするのではなく、ひどいコードは修正すべきである。逆に、書き手の考えていることや、コードの欠陥を伝えるためにはコメントを使うべきである。

的確で簡潔なコメントを書くために、曖昧な代名詞を避けたり、関数の入出力の例を示したりすれば良い。

### 制御フロー

条件分岐やループなどの**制御フロー**があると、他の場所にジャンプしたり枝分かれするので、コードを読むのが困難になる。そのため、制御フローはなるべく読みやすくなるように工夫する必要がある。

`if (x < 10)` のような、条件式の左側には**変化する「調査対象」**の値を置き、右側には**あまり変化しない「比較対象」**をおくべきである。これは英語の用法に合わせるためである。

if/else ブロックの並び順は、以下のルールに従って書くと良い。ただし、否定形の条件であっても、単純で関心をひく場合がある。例えば「エラー処理」などは先に処理することが多い。

- 条件は否定系よりも肯定系を優先する。
- 単純な条件を先に書く。
- 関心を引く条件や目立つ条件を先に書く。

**三項演算子**も、むやみやたらに使用するのではなく、それによって簡潔になるときだけ使用する。重要なのは、行数を短くするよりも、読み手が理解するのにかかる時間を短くすることである。

**ネスト**したコードを追うのには集中力を要する。関数内での深いネストを避けるのに、早めに返り値を返すことが有効になることがある。ループ文の内部でのネストを避けるには、`continue` を使用して、関数内と同様の対処ができる。

### 変数

**説明変数**（式を表す変数）を**追加**すれば、巨大な式を分割できる。こうすることで、式が何を表しているかを読み手は一目で理解できる。また、コードの主要な概念が認識しやすくなる。

変数を追加することでコードが読みやすくなることもあれば、不要な変数を**削除**することでコードが簡潔になることもある。役に立たない**一時変数**や、中間結果を保持するためだけの変数は使わなくても実装できることが多い。変数が多いと追跡する対象が多くなるので、読み手に集中力を要してしまう。

追跡が困難という意味で**グローバル変数**は避けるべきである。変数のスコープは短い方がいい。また、変数はなるべく定数として扱うべきである。何度も変更が可能な「生きている」変数が多いと、読み手は追跡が困難になる。JavaScript では `const` を使用して実装する。

### 機能を切り出す

**プロジェクト固有のコード**から**汎用的なコード**を分離する。つまり、高レベルなビジネスロジックから、それの実現とは直接関係のない、別の下位問題を解決しているコードを切り出す。汎用コードなどが、下位問題を解決しているコードの例である。分離することで、読み手が**詳細**に注意を取られなくなる。また、コードを独立させることで、修正が楽になる。

コード（関数）は、**一度に 1 つのタスクのみを行うべき**である。
複数の処理を行なっているコード（関数）があれば、そこで行われているタスクを列挙する。別の関数に分割できるタスクは分割する。それ以外の部分は、関数の論理的なステップであるため、読み手は理解するのに苦労しない。

### できるだけコードを書かない

プロジェクトを始めてすぐの状態、つまりソースファイルが数個しかない場合、コードを読むのは簡単である。しかし、プロジェクトが進み、ファイルが増えていくと、コード同士の関係を理解したり、機能を追加するのが困難になる。プロジェクトが成長しても、**コードはできるだけ小さく軽量に維持するべき**である。そのためにするべきことは以下のことである。

- 汎用的なコードを作って、重複を排除する。
- 未使用のコードや無用の機能を削除する。
- プロジェクトをサブプロジェクトに分割する。
- コードを軽量にする。
